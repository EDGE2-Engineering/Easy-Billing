
import React from 'react';
import { MermaidDiagram } from '@lightenna/react-mermaid-diagram';
import { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';
import { Button } from '@/components/ui/button';
import { Ruler, Hash, CreditCard, FileText, Axe, Building2, Info, CheckCircle2, ChevronRight, ZoomIn, ZoomOut, RotateCcw } from 'lucide-react';
import { TransformWrapper, TransformComponent } from "react-zoom-pan-pinch";
import AdminUnitTypesManager from './AdminUnitTypesManager';
import AdminHSNCodesManager from './AdminHSNCodesManager';
import AdminSettingsManager from './AdminSettingsManager';
import AdminTermsManager from './AdminTermsManager';
import AdminTechnicalsManager from './AdminTechnicalsManager';
import AdminDepartmentsManager from './AdminDepartmentsManager';

const AdminSystemSettings = () => {
    return (
        <div className="space-y-4">
            <Tabs defaultValue="unit_types" className="w-full">
                <div className="flex justify-center mb-6">
                    <TabsList className="bg-white p-1 border border-gray-200 rounded-xl shadow-sm h-auto inline-flex flex-wrap justify-center">
                        <TabsTrigger
                            value="unit_types"
                            className="px-2 py-2 rounded-lg data-[state=active]:bg-primary data-[state=active]:text-white transition-all flex items-center gap-2"
                        >
                            <Ruler className="w-4 h-4" /> Units
                        </TabsTrigger>
                        <TabsTrigger
                            value="hsn_codes"
                            className="px-2 py-2 rounded-lg data-[state=active]:bg-primary data-[state=active]:text-white transition-all flex items-center gap-2"
                        >
                            <Hash className="w-4 h-4" /> Codes
                        </TabsTrigger>

                        <TabsTrigger
                            value="terms"
                            className="px-2 py-2 rounded-lg data-[state=active]:bg-primary data-[state=active]:text-white transition-all flex items-center gap-2"
                        >
                            <FileText className="w-4 h-4" /> T&C
                        </TabsTrigger>
                        <TabsTrigger
                            value="technicals"
                            className="px-2 py-2 rounded-lg data-[state=active]:bg-primary data-[state=active]:text-white transition-all flex items-center gap-2"
                        >
                            <Axe className="w-4 h-4" /> Technicals
                        </TabsTrigger>

                        <TabsTrigger
                            value="payment_settings"
                            className="px-2 py-2 rounded-lg data-[state=active]:bg-primary data-[state=active]:text-white transition-all flex items-center gap-2"
                        >
                            <CreditCard className="w-4 h-4" /> Payment
                        </TabsTrigger>
                        <TabsTrigger
                            value="departments"
                            className="px-2 py-2 rounded-lg data-[state=active]:bg-primary data-[state=active]:text-white transition-all flex items-center gap-2"
                        >
                            <Building2 className="w-4 h-4" /> Departments
                        </TabsTrigger>
                        <TabsTrigger
                            value="info"
                            className="px-2 py-2 rounded-lg data-[state=active]:bg-primary data-[state=active]:text-white transition-all flex items-center gap-2"
                        >
                            <Info className="w-4 h-4" /> Info
                        </TabsTrigger>
                    </TabsList>
                </div>

                <TabsContent value="unit_types" className="focus-visible:outline-none animate-in fade-in slide-in-from-bottom-2 duration-300">
                    <AdminUnitTypesManager />
                </TabsContent>

                <TabsContent value="hsn_codes" className="focus-visible:outline-none animate-in fade-in slide-in-from-bottom-2 duration-300">
                    <AdminHSNCodesManager />
                </TabsContent>

                <TabsContent value="payment_settings" className="focus-visible:outline-none animate-in fade-in slide-in-from-bottom-2 duration-300">
                    <AdminSettingsManager />
                </TabsContent>

                <TabsContent value="terms" className="focus-visible:outline-none animate-in fade-in slide-in-from-bottom-2 duration-300">
                    <AdminTermsManager />
                </TabsContent>

                <TabsContent value="technicals" className="focus-visible:outline-none animate-in fade-in slide-in-from-bottom-2 duration-300">
                    <AdminTechnicalsManager />
                </TabsContent>


                <TabsContent value="departments" className="focus-visible:outline-none animate-in fade-in slide-in-from-bottom-2 duration-300">
                    <AdminDepartmentsManager />
                </TabsContent>

                <TabsContent value="info" className="focus-visible:outline-none animate-in fade-in slide-in-from-bottom-2 duration-300">
                    <div className="bg-white p-8 rounded-2xl border border-gray-100 shadow-sm space-y-8">
                        <div>
                            <h2 className="text-2xl font-bold text-gray-900 flex items-center gap-3 mb-2">
                                <Info className="w-6 h-6 text-primary" /> System Information & Help
                            </h2>
                            <p className="text-gray-500">Learn how to use the EDGE2 Easy Billing & Inward Management System effectively.</p>
                        </div>

                        <div className="grid grid-cols-1 md:grid-cols-2 gap-8">
                            <div className="space-y-4">
                                <h3 className="text-lg font-semibold text-gray-800 flex items-center gap-2 border-b pb-2">
                                    <div className="w-2 h-2 rounded-full bg-primary" />
                                    Inward Management
                                </h3>
                                <div className="space-y-3">
                                    {[
                                        "Register new samples received from clients with auto-generated Job Order numbers.",
                                        "Track sample status from 'Received' through 'Testing' to 'Completed'.",
                                        "Manage multiple samples under a single inward entry for bulk processing.",
                                        "Filter and search records by Job Order #, PO/WO #, or Client name."
                                    ].map((text, i) => (
                                        <div key={i} className="flex gap-3 text-sm text-gray-600">
                                            <CheckCircle2 className="w-4 h-4 text-green-500 shrink-0 mt-0.5" />
                                            <span>{text}</span>
                                        </div>
                                    ))}
                                </div>
                            </div>

                            <div className="space-y-4">
                                <h3 className="text-lg font-semibold text-gray-800 flex items-center gap-2 border-b pb-2">
                                    <div className="w-2 h-2 rounded-full bg-blue-500" />
                                    Billing & Document Generation
                                </h3>
                                <div className="space-y-3">
                                    {[
                                        "Generate Quotations, Tax Invoices, and Proforma Invoices with consistent numbering.",
                                        "Automatic tax calculations (GST) based on selected services and HSN codes.",
                                        "Store and manage Terms & Conditions for different types of clients.",
                                        "Export documents to professional PDF formats for client distribution."
                                    ].map((text, i) => (
                                        <div key={i} className="flex gap-3 text-sm text-gray-600">
                                            <CheckCircle2 className="w-4 h-4 text-blue-500 shrink-0 mt-0.5" />
                                            <span>{text}</span>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        </div>

                        <div className="bg-primary/5 p-6 rounded-xl border border-primary/10">
                            <h3 className="text-sm font-bold text-primary uppercase tracking-widest mb-4">Quick Tips</h3>
                            <div className="grid grid-cols-1 sm:grid-cols-3 gap-6">
                                <div className="space-y-1">
                                    <p className="text-xs font-bold text-gray-900">Searchable Lists</p>
                                    <p className="text-xs text-gray-500">Most management pages include real-time search and advanced filters.</p>
                                </div>
                                <div className="space-y-1">
                                    <p className="text-xs font-bold text-gray-900">Tablet & Desktop Ready</p>
                                    <p className="text-xs text-gray-500">The entire system is optimized for tablet and desktop use.</p>
                                </div>
                                <div className="space-y-1">
                                    <p className="text-xs font-bold text-gray-900">Data Integrity</p>
                                    <p className="text-xs text-gray-500">All changes represent real-time updates to the database.</p>
                                </div>
                            </div>
                        </div>

                        <div className="space-y-6 pt-4 border-t border-gray-100">
                            <div className="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4">
                                <div>
                                    <h3 className="text-lg font-semibold text-gray-800 flex items-center gap-2 mb-2">
                                        <div className="w-2 h-2 rounded-full bg-purple-500" />
                                        System Process Flow
                                    </h3>
                                    <p className="text-sm text-gray-500 italic">Visual representation of the standard material testing and billing cycle.</p>
                                </div>
                            </div>

                            <div className="bg-white p-4 rounded-xl border border-gray-100 shadow-inner overflow-hidden relative group min-h-[600px] min-w-[600px]">
                                <TransformWrapper
                                    initialScale={1}
                                    initialPositionX={0}
                                    initialPositionY={0}
                                    centerOnInit={true}
                                    minScale={0.5}
                                    maxScale={3}
                                >
                                    {({ zoomIn, zoomOut, resetTransform }) => (
                                        <>
                                            <div className="absolute top-4 right-4 z-10 flex flex-col gap-2 opacity-0 group-hover:opacity-100 transition-opacity">
                                                <Button
                                                    variant="secondary"
                                                    size="icon"
                                                    className="w-10 h-10 rounded-xl bg-white/80 backdrop-blur shadow-sm border border-gray-200 hover:bg-white"
                                                    onClick={() => zoomIn()}
                                                    title="Zoom In"
                                                >
                                                    <ZoomIn className="w-5 h-5 text-gray-600" />
                                                </Button>
                                                <Button
                                                    variant="secondary"
                                                    size="icon"
                                                    className="w-10 h-10 rounded-xl bg-white/80 backdrop-blur shadow-sm border border-gray-200 hover:bg-white"
                                                    onClick={() => zoomOut()}
                                                    title="Zoom Out"
                                                >
                                                    <ZoomOut className="w-5 h-5 text-gray-600" />
                                                </Button>
                                                <Button
                                                    variant="secondary"
                                                    size="icon"
                                                    className="w-10 h-10 rounded-xl bg-white/80 backdrop-blur shadow-sm border border-gray-200 hover:bg-white"
                                                    onClick={() => resetTransform()}
                                                    title="Reset View"
                                                >
                                                    <RotateCcw className="w-5 h-5 text-gray-600" />
                                                </Button>
                                            </div>
                                            <div className="flex justify-center w-full">
                                                <TransformComponent
                                                    wrapperProps={{
                                                        style: {
                                                            width: "100%",
                                                            height: "600px",
                                                            cursor: "grab",
                                                        }
                                                    }}
                                                    contentProps={{
                                                        style: {
                                                            width: "100%",
                                                            display: "flex",
                                                            justifyContent: "center"
                                                        }
                                                    }}
                                                >
                                                    <div className="p-8">
                                                        <MermaidDiagram>
                                                            {`
                                                                flowchart TD
                                                                    A["Receive PO/WO from Client (After Quotation Approval)"] --> B
                                                                    A --> C
                                                                
                                                                    B["Generate Unified Identification Number (UIN) / Job Order Number upon Receipt of PO/WO and Material"] --> D
                                                                    D --> |"Testing Process (4–5 Days)"| F
                                                                
                                                                    C["Accounts Team Raises Proforma Invoice upon Receipt of PO/WO and Sends to Client"]
                                                                
                                                                    D["Material Receiving Officer (MRO) Labels Material with UIN and Prepares Job Card cum Result Sheet (Internal Hard Copy), then Forwards to Relevant Department (Chemical / Physical / Soil / NDT)"]
                                                                
                                                                    F["Respective Department Conducts Testing and Records Results in Job Card cum Result Sheet (Internal Hard Copy), then Returns to MRO/Typist"] --> G
                                                                
                                                                    G["MRO Generates Final Report with ULR Number and Report Number"] --> H
                                                                    H["Authorized Signatory Reviews and Signs the Report"] --> I
                                                                    I["Seal Report, Scan & Photocopy; Send Scanned Copy to Accounts Team"] --> J
                                                                
                                                                    J["Accounts Team Confirms Payment Receipt; Upon Confirmation, Release Final Report to Client"]
                                                            `}
                                                        </MermaidDiagram>
                                                    </div>
                                                </TransformComponent>
                                            </div>
                                        </>
                                    )}
                                </TransformWrapper>
                                <div className="absolute bottom-4 left-1/2 transform -translate-x-1/2 bg-gray-900/50 backdrop-blur-sm text-white px-4 py-1.5 rounded-full text-[10px] font-medium tracking-wider uppercase pointer-events-none opacity-0 group-hover:opacity-100 transition-opacity">
                                    Drag to Pan • use buttons to zoom
                                </div>
                            </div>
                        </div>
                    </div>
                </TabsContent>
            </Tabs>
        </div>
    );
};

export default AdminSystemSettings;
